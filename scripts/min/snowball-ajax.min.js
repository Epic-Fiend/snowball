function parseBlock(a){var e=a.data("type"),t="input[type='text'][data-target], input[type='email'][data-target], input[type='range'][data-target], input[type='hidden'][data-target], input[type='radio'][data-target]:checked, input[type='checkbox'][data-target], textarea[data-target], select[data-target]",n=a.find(".snowball-tinker form").first().find(t),o={};return n&&(o.blockType=e,n.each(function(a,e){var t=jQuery(e).attr("data-target"),n=jQuery(e).val();"checkbox"==jQuery(e).attr("type")&&(n=jQuery(e).is(":checked")?!0:!1),o[t]=n}),o.customCss=retrieveCustomCss(a)),o}function retrieveCustomCss(a){var e,t=a.find(".snowball-code .CodeMirror");if(0===t.length)e=a.find("textarea[data-mode='css']").html();else{var n=t[1].CodeMirror,o=n.getAllMarks();if(e=n.getValue(),o.length){var r=o[0],c=r.lines.length;if(2>c)e=n.getValue();else{var i={line:c-1,ch:0},l={line:n.lastLine()+1,ch:0};e=n.getRange(i,l)}}}return e}jQuery(document).ready(function(a){function e(){var e=[];return a(".snowball-block").each(function(){var t=parseBlock(a(this));e.push(t)}),e}function t(){var a="";return jQuery(".snowball-preview").each(function(e,t){var n=jQuery(t).contents().find("body").clone();n.find("svg").remove(),a=a+"\n"+n.html(),n.remove()}),a}a("#publish, #save-post").click(function(){var n=e(),o=t(),r={action:"add_blocks",blocks:n,post_id:ajax_object.post_id,snowball_ajax_nonce:ajax_object.snowball_ajax_nonce},c={action:"add_article",article:o,post_id:ajax_object.post_id,is_preview:"false",snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};a.post(ajax_object.ajax_url,c),a.post(ajax_object.ajax_url,r)}),a("#post-preview").click(function(){var e=t(),n={action:"add_article",article:e,post_id:ajax_object.post_id,is_preview:"true",snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};a.post(ajax_object.ajax_url,n)})});
//# sourceMappingURL=snowball-ajax.min.js.map