function parseBlock(t){var a=t.data("type"),e="input[type='text'][data-target], input[type='email'][data-target], input[type='range'][data-target], input[type='hidden'][data-target], input[type='radio'][data-target]:checked, input[type='checkbox'][data-target], textarea[data-target], select[data-target]",n=t.find(".snowball-tinker form").first().find(e),r={};return n&&(r.blockType=a,n.each(function(t,a){var e=jQuery(a).attr("data-target"),n=jQuery(a).val();"checkbox"==jQuery(a).attr("type")&&(n=jQuery(a).is(":checked")?!0:!1),r[e]=n}),r.customCss=retrieveCustomCss(t)),r}function retrieveCustomCss(t){var a,e=t.find(".snowball-code .CodeMirror");if(0===e.length)a=t.find("textarea[data-mode='css']").html();else{var n=e[1].CodeMirror,r=n.getAllMarks();if(a=n.getValue(),r.length){var o=r[0],c=o.lines.length;if(2>c)a=n.getValue();else{var i={line:c-1,ch:0},l={line:n.lastLine()+1,ch:0};a=n.getRange(i,l)}}}return a}jQuery(document).ready(function(t){function a(){var a=[];return t(".snowball-block").each(function(){var e=parseBlock(t(this));a.push(e)}),a}function e(){var t="";return jQuery(".snowball-preview").each(function(a,e){var n=jQuery(e).contents().find("body");n.find("svg").remove(),t=t+"\n"+n.html()}),t}t("#publish, #save-post").click(function(){var n=a(),r=e(),o={action:"add_blocks",blocks:n,post_id:ajax_object.post_id,snowball_ajax_nonce:ajax_object.snowball_ajax_nonce},c={action:"add_article",article:r,post_id:ajax_object.post_id,snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};t.post(ajax_object.ajax_url,c),t.post(ajax_object.ajax_url,o)})});
//# sourceMappingURL=snowball-ajax.min.js.map