function parseBlock(e){var t=e.data("type"),a="input[type='text'][data-target], input[type='email'][data-target], input[type='range'][data-target], input[type='hidden'][data-target], input[type='radio'][data-target]:checked, input[type='checkbox'][data-target], textarea[data-target], select[data-target]",n=e.find(".snowball-tinker form").first().find(a),o={};return n&&(o.blockType=t,n.each(function(e,t){var a=jQuery(t).attr("data-target"),n=jQuery(t).val();"checkbox"==jQuery(t).attr("type")&&(n=jQuery(t).is(":checked")?!0:!1),o[a]=n}),o.customCss=retrieveCustomCss(e)),o}function retrieveCustomCss(e){var t,a=e.find(".snowball-code .CodeMirror");if(0===a.length)t=e.find("textarea[data-mode='css']").html();else{var n=a[1].CodeMirror,o=n.getAllMarks();if(t=n.getValue(),o.length){var r=o[0],i=r.lines.length;if(2>i)t=n.getValue();else{var c={line:i-1,ch:0},l={line:n.lastLine()+1,ch:0};t=n.getRange(c,l)}}}return t}jQuery(document).ready(function(e){function t(){var t=1;return e("#theme_option").is(":checked")&&(t=0),t}function a(){var t=[];return e(".snowball-block").each(function(){var a=parseBlock(e(this));t.push(a)}),t}function n(){var e="";return jQuery(".snowball-preview").each(function(t,a){var n=jQuery(a).contents().find("body").clone();n.find("svg").remove(),e=e+"\n"+n.html(),n.remove()}),e}e("#publish, #save-post").click(function(){var o=a(),r=n(),i={action:"add_blocks",blocks:o,post_id:ajax_object.post_id,snowball_ajax_nonce:ajax_object.snowball_ajax_nonce},c={action:"add_article",article:r,theme_option:t(),post_id:ajax_object.post_id,is_preview:"false",snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};e.post(ajax_object.ajax_url,c),e.post(ajax_object.ajax_url,i)}),e("#post-preview").click(function(){var a=n(),o={action:"add_article",article:a,theme_option:t(),post_id:ajax_object.post_id,is_preview:"true",snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};e.post(ajax_object.ajax_url,o)})});
//# sourceMappingURL=snowball-ajax.min.js.map