function parseBlock(a){var t=a.data("type"),e="input[type='text'][data-target], input[type='email'][data-target], input[type='range'][data-target], input[type='hidden'][data-target], input[type='radio'][data-target]:checked, input[type='checkbox'][data-target], textarea[data-target], select[data-target]",n=a.find(".snowball-tinker form").first().find(e),o={};return n&&(o.blockType=t,n.each(function(a,t){var e=jQuery(t).attr("data-target"),n=jQuery(t).val();"checkbox"==jQuery(t).attr("type")&&(n=jQuery(t).is(":checked")?!0:!1),o[e]=n}),o.customCss=retrieveCustomCss(a)),o}function retrieveCustomCss(a){var t,e=a.find(".snowball-code .CodeMirror");if(0===e.length)t=a.find("textarea[data-mode='css']").html();else{var n=e[1].CodeMirror,o=n.getAllMarks();if(t=n.getValue(),o.length){var r=o[0],i=r.lines.length;if(2>i)t=n.getValue();else{var c={line:i-1,ch:0},l={line:n.lastLine()+1,ch:0};t=n.getRange(c,l)}}}return t}jQuery(document).ready(function(a){function t(){var t=[];return a(".snowball-block").each(function(){var e=parseBlock(a(this));t.push(e)}),t}function e(){var a="";return jQuery(".snowball-preview").each(function(t,e){var n=jQuery(e).contents().find("body");n.find("svg").remove(),a=a+"\n"+n.html()}),a}a("#publish, #save-post").click(function(){var n=t(),o=e(),r={action:"add_blocks",blocks:n,post_id:ajax_object.post_id,snowball_ajax_nonce:ajax_object.snowball_ajax_nonce},i={action:"add_article",article:o,post_id:ajax_object.post_id,is_preview:"false",snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};a.post(ajax_object.ajax_url,i),a.post(ajax_object.ajax_url,r)}),a("#post-preview").click(function(){var t=e(),n={action:"add_article",article:t,post_id:ajax_object.post_id,is_preview:"true",snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};a.post(ajax_object.ajax_url,n)})});
//# sourceMappingURL=snowball-ajax.min.js.map