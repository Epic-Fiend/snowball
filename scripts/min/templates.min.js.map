{"version":3,"sources":["choropleth/template.js","contact/template.js","share/template.js"],"names":["drawMap","block","snowball","window","parent","path","pluginsUrl","json","find","val","container","get","quantize","parseInt","color","palette","colorbrewer","mapType","file","projection","d3","geo","albersUsa","scale","equirectangular","empty","map","geomap","choropleth","geofile","column","unitId","translate","colors","legend","select","datum","JSON","parse","call","draw","selectAll","attr","$","document","ready","choropleths","each","this","jQuery","on","form","closest","to","subject","confirmation","message","others","not","data","action","post","adminUrl","response","text","url","button","width","height","windowLeft","screen","windowTop","opts","hasClass","encodeURIComponent","title","excerpt","open"],"mappings":"AAYA,QAAAA,SAAAC,GACA,GAAAC,GAAAA,GAAAC,OAAAC,OAAAF,SACAG,EAAAH,EAAAI,WAAA,iBAEAC,EAAAN,EAAAO,KAAA,aAAAC,MACAC,EAAAT,EAAAO,KAAA,QAAAG,IAAA,GACAC,EAAAC,SAAAZ,EAAAO,KAAA,kBAAAC,OACAK,EAAAb,EAAAO,KAAA,eAAAC,MACAM,EAAAC,YAAAF,GAAAF,GAEAK,EAAAhB,EAAAO,KAAA,aAAAC,MACAS,EAAAb,EAAA,+BACAc,EAAAC,GAAAC,IAAAC,UACAC,EAAA,GASA,IAPA,UAAAN,IACAV,EAAAN,EAAAO,KAAA,eAAAC,MACAS,EAAAb,EAAA,iCACAc,EAAAC,GAAAC,IAAAG,gBACAD,EAAA,KAGAhB,EAAA,CACAN,EAAAO,KAAA,QAAAiB,OAEA,IAAAC,GAAAN,GAAAO,OAAAC,aACAC,QAAAX,GACAC,WAAAA,GACAW,OAAA,SACAC,OAAA,QACAR,MAAAA,GACAS,WAAA,IAAA,MACAC,OAAAlB,GACAmB,QAAA,EAEAd,IAAAe,OAAAzB,GACA0B,MAAAC,KAAAC,MAAA/B,IACAgC,KAAAb,EAAAc,KAAAd,GACAe,UAAA,OAAAC,KAAA,sBAAA,iBAAAA,KAAA,UAAA,iBAlDA,SAAAC,GACAA,EAAAC,UAAAC,MAAA,WAEA,GAAAC,GAAAH,EAAA,6BACAG,GAAAC,KAAA,WACA/C,QAAA2C,EAAAK,YAIAC,QCTA,SAAAN,GACAA,EAAAC,UAAAC,MAAA,WAEAF,EAAA,QAAAO,GAAA,QAAA,kCAAA,WACA,GAAAC,GAAAR,EAAAK,MAAAI,QAAA,QACAC,EAAAF,EAAA3C,KAAA,eAAAC,MACA6C,EAAAH,EAAA3C,KAAA,oBAAAC,MACA8C,EAAAJ,EAAA3C,KAAA,yBAAAC,MACA+C,EAAA,GACAC,EAAAN,EAAA3C,KAAA,mBAAAkD,IAAA,kBAEAD,GAAAV,KAAA,WACA,GAAAtC,GAAAkC,EAAAK,MAAAvC,KAGA+C,GADAb,EAAAK,MAAAN,KAAA,QACAc,EAAA,OAAAb,EAAAK,MAAAN,KAAA,QAAA,KAAAjC,EAEA+C,EAAA,OAAA/C,GAIA,IAAAkD,IACAC,OAAA,qBACAP,GAAAA,EACAC,QAAAA,EACAE,QAAAA,EAGArD,QAAAC,SACAF,SAAAC,OAAAC,OAAAF,UAGA+C,OAAAY,KAAA3D,SAAA4D,SAAA,iBAAAH,EAAA,SAAAI,GACAZ,EAAAa,KAAAT,UAKAN,QCtCA,SAAAN,GACAA,EAAAC,UAAAC,MAAA,WAEAF,EAAA,QAAAO,GAAA,QAAA,gCAAA,WACA,GAOAe,GAPA/D,EAAAA,GAAAC,OAAAC,OAAAF,SACAgE,EAAAjB,OAAAD,MACAmB,EAAA,IACAC,EAAA,IACAC,EAAAC,OAAAH,MAAA,EAAAA,EAAA,EACAI,EAAAD,OAAAF,OAAA,EAAAA,EAAA,EACAI,EAAA,4BAAAL,EAAA,WAAAC,EAAA,QAAAG,EAAA,SAAAF,CAIAJ,GADAC,EAAAO,SAAA,YACA,wCAAAC,mBAAAxE,EAAA+D,KACAC,EAAAO,SAAA,WACA,gCAAAC,mBAAAxE,EAAA+D,KAAA,SAAAS,mBAAAxE,EAAAyE,OACAT,EAAAO,SAAA,UACA,wEAAAC,mBAAAxE,EAAA+D,KAAA,UAAAS,mBAAAxE,EAAAyE,OAAA,YAAAD,mBAAAxE,EAAA0E,SAEA,qCAAAF,mBAAAxE,EAAA+D,KAGA9D,OAAA0E,KAAAZ,EAAA,QAAAO,QAIAvB","file":"templates.min.js","sourcesContent":["(function($) {\n  $(document).ready(function() {\n\n    var choropleths = $(\".snowball-block-choropleth\");\n    choropleths.each(function() {\n      drawMap($(this));\n    });\n\n  });\n})(jQuery);\n\n\nfunction drawMap(block) {\n  var snowball = snowball || window.parent.snowball;\n  var path = snowball.pluginsUrl + \"/lib/d3-geomap\";\n\n  var json = block.find(\".json-usa\").val();\n  var container = block.find(\".map\").get(0);\n  var quantize = parseInt(block.find(\"input.quantize\").val());\n  var color = block.find(\"input.color\").val();\n  var palette = colorbrewer[color][quantize];\n\n  var mapType = block.find(\".map-type\").val();\n  var file = path + \"/topojson/countries/USA.json\";\n  var projection = d3.geo.albersUsa;\n  var scale = 800;\n\n  if (mapType === \"world\") {\n    json = block.find(\".json-world\").val();\n    file = path + \"/topojson/world/countries.json\";\n    projection = d3.geo.equirectangular;\n    scale = 100;\n  }\n\n  if (json) {\n    block.find(\".map\").empty();\n\n    var map = d3.geomap.choropleth()\n      .geofile(file)\n      .projection(projection)\n      .column(\"Value\")\n      .unitId(\"fips\")\n      .scale(scale)\n      .translate([400, 200])\n      .colors(palette)\n      .legend(true);\n\n   d3.select(container)\n     .datum(JSON.parse(json))\n     .call(map.draw, map)\n     .selectAll(\"svg\").attr(\"preserveAspectRatio\", \"xMinYMin meet\").attr(\"viewBox\", \"0 0 500 400\");\n  }\n}\n","(function($) {\n  $(document).ready(function() {\n\n    $(\"body\").on(\"click\", \".snowball-block-contact .submit\", function() {\n      var form = $(this).closest(\"form\");\n      var to = form.find(\"[name='to']\").val();\n      var subject = form.find(\"[name='subject']\").val();\n      var confirmation = form.find(\"[name='confirmation']\").val();\n      var message = \"\";\n      var others = form.find(\"input, textarea\").not(\"[type='hidden']\");\n\n      others.each(function() {\n        var val = $(this).val();\n\n        if ($(this).attr(\"name\")) {\n          message = message + \"\\n\\n\" + $(this).attr(\"name\") + \": \" + val;\n        } else {\n          message = message + \"\\n\\n\" + val;\n        }\n      });\n\n      var data = {\n        action: \"mail_before_submit\",\n        to: to,\n        subject: subject,\n        message: message\n      };\n\n      if (window.parent) {\n        snowball = window.parent.snowball;\n      }\n\n      jQuery.post(snowball.adminUrl + \"admin-ajax.php\", data, function(response) {\n        form.text(confirmation);\n      });\n    });\n\n  });\n})(jQuery);\n","(function($) {\n  $(document).ready(function() {\n\n    $(\"body\").on(\"click\", \".snowball-block-share .button\", function() {\n      var snowball = snowball || window.parent.snowball;\n      var button = jQuery(this);\n      var width = 500;\n      var height = 400;\n      var windowLeft = (screen.width/2) - (width/2);\n      var windowTop = (screen.height/2) - (height/2);\n      var opts = \"toolbar=0,status=0,width=\" + width + \",height=\" + height + \",top=\" + windowTop + \",left=\" + windowLeft;\n      var url;\n\n      if (button.hasClass(\"facebook\")) {\n        url = \"http://www.facebook.com/sharer.php?u=\" + encodeURIComponent(snowball.url);\n      } else if (button.hasClass(\"twitter\")) {\n        url = \"http://twitter.com/share?url=\" + encodeURIComponent(snowball.url) + \"&text=\" + encodeURIComponent(snowball.title);\n      } else if (button.hasClass(\"tumblr\")) {\n        url = \"https://www.tumblr.com/widgets/share/tool?posttype=link&canonicalUrl=\" + encodeURIComponent(snowball.url) + \"&title=\" + encodeURIComponent(snowball.title) + \"&content=\" + encodeURIComponent(snowball.excerpt);\n      } else {\n        url = \"https://plus.google.com/share?url=\" + encodeURIComponent(snowball.url);\n      }\n\n      window.open(url, \"share\", opts);\n    });\n\n  });\n})(jQuery);\n"],"sourceRoot":"/source/"}