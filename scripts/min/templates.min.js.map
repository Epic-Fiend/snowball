{"version":3,"sources":["choropleth/template.js","scatterplot/template.js","contact/template.js","share/template.js"],"names":["drawMap","block","snowball","window","parent","path","pluginsUrl","json","find","val","container","get","quantize","parseInt","color","palette","colorbrewer","mapType","file","projection","d3","geo","albersUsa","scale","equirectangular","empty","map","geomap","choropleth","geofile","column","unitId","translate","colors","legend","select","datum","JSON","parse","call","draw","selectAll","attr","drawScatterplot","size","data","dataset","xdata","ydata","forEach","d","push","X","Y","margin","top","right","bottom","left","width","height","x","linear","domain","max","range","y","chart","append","main","xAxis","svg","axis","orient","yAxis","g","enter","i","$","document","ready","choropleths","each","this","jQuery","on","form","closest","to","subject","confirmation","message","others","not","action","post","adminUrl","response","text","url","button","windowLeft","screen","windowTop","opts","hasClass","encodeURIComponent","title","excerpt","open"],"mappings":"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","file":"templates.min.js","sourcesContent":["(function($) {\n  $(document).ready(function() {\n\n    var choropleths = $(\".snowball-block-choropleth\");\n    choropleths.each(function() {\n      drawMap($(this));\n    });\n\n  });\n})(jQuery);\n\n\nfunction drawMap(block) {\n  var snowball = snowball || window.parent.snowball;\n  var path = snowball.pluginsUrl + \"/lib/d3-geomap\";\n\n  var json = block.find(\".json-usa\").val();\n  var container = block.find(\".map\").get(0);\n  var quantize = parseInt(block.find(\"input.quantize\").val());\n  var color = block.find(\"input.color\").val();\n  var palette = colorbrewer[color][quantize];\n\n  var mapType = block.find(\".map-type\").val();\n  var file = path + \"/topojson/countries/USA.json\";\n  var projection = d3.geo.albersUsa;\n  var scale = 800;\n\n  if (mapType === \"world\") {\n    json = block.find(\".json-world\").val();\n    file = path + \"/topojson/world/countries.json\";\n    projection = d3.geo.equirectangular;\n    scale = 100;\n  }\n\n  if (json) {\n    block.find(\".map\").empty();\n\n    var map = d3.geomap.choropleth()\n      .geofile(file)\n      .projection(projection)\n      .column(\"Value\")\n      .unitId(\"fips\")\n      .scale(scale)\n      .translate([400, 200])\n      .colors(palette)\n      .legend(true);\n\n   d3.select(container)\n     .datum(JSON.parse(json))\n     .call(map.draw, map)\n     .selectAll(\"svg\").attr(\"preserveAspectRatio\", \"xMinYMin meet\").attr(\"viewBox\", \"0 0 500 400\");\n  }\n}\n","(function($) {\n  $(document).ready(function() {\n\n    var choropleths = $(\".snowball-block-scatterplot\");\n    choropleths.each(function() {\n      drawScatterplot($(this));\n    });\n\n  });\n})(jQuery);\n\nfunction drawScatterplot(block) {\n  var json = block.find(\".json\").val();\n\n  if (json) {\n    var container = block.find(\".chart\").get(0);\n    var size = block.find(\".size\").val();\n    var data = JSON.parse(json);\n    var dataset = [];\n    var xdata = [];\n    var ydata = [];\n\n    data.forEach(function(d) {\n      dataset.push([d.X, d.Y]);\n      xdata.push(d.X);\n      ydata.push(d.Y);\n    });\n\n    var margin = {top: 40, right: 40, bottom: 60, left: 60};\n    var width = 800 - margin.left - margin.right;\n    var height = 400 - margin.top - margin.bottom;\n\n    var x = d3.scale.linear()\n              .domain([0, d3.max(xdata)])\n              .range([ 0, width ]);\n\n    var y = d3.scale.linear()\n              .domain([0, d3.max(ydata)])\n              .range([ height, 0 ]);\n\n    var chart = d3.select(container)\n      .append('svg:svg')\n      .attr('width', width + margin.right + margin.left)\n      .attr('height', height + margin.top + margin.bottom)\n      .attr('class', 'chart');\n\n    var main = chart.append('g')\n      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')\n      .attr('width', width)\n      .attr('height', height)\n      .attr('class', 'main');\n\n    var xAxis = d3.svg.axis()\n      .scale(x)\n      .orient('bottom');\n\n    main.append('g')\n      .attr('transform', 'translate(0,' + height + ')')\n      .attr('class', 'main axis date')\n      .call(xAxis);\n\n    var yAxis = d3.svg.axis()\n      .scale(y)\n      .orient('left');\n\n    main.append('g')\n      .attr('transform', 'translate(0,0)')\n      .attr('class', 'main axis date')\n      .call(yAxis);\n\n    var g = main.append(\"svg:g\"); \n\n    g.selectAll(\"scatter-dots\")\n      .data(ydata)\n      .enter().append(\"svg:circle\")\n          .attr(\"cy\", function (d) { return y(d); } )\n          .attr(\"cx\", function (d,i) { return x(xdata[i]); } )\n          .attr(\"r\", size);\n\n  }\n}\n","(function($) {\n  $(document).ready(function() {\n\n    $(\"body\").on(\"click\", \".snowball-block-contact .submit\", function() {\n      var form = $(this).closest(\"form\");\n      var to = form.find(\"[name='to']\").val();\n      var subject = form.find(\"[name='subject']\").val();\n      var confirmation = form.find(\"[name='confirmation']\").val();\n      var message = \"\";\n      var others = form.find(\"input, textarea\").not(\"[type='hidden']\");\n\n      others.each(function() {\n        var val = $(this).val();\n\n        if ($(this).attr(\"name\")) {\n          message = message + \"\\n\\n\" + $(this).attr(\"name\") + \": \" + val;\n        } else {\n          message = message + \"\\n\\n\" + val;\n        }\n      });\n\n      var data = {\n        action: \"mail_before_submit\",\n        to: to,\n        subject: subject,\n        message: message\n      };\n\n      if (window.parent) {\n        snowball = window.parent.snowball;\n      }\n\n      jQuery.post(snowball.adminUrl + \"admin-ajax.php\", data, function(response) {\n        form.text(confirmation);\n      });\n    });\n\n  });\n})(jQuery);\n","(function($) {\n  $(document).ready(function() {\n\n    $(\"body\").on(\"click\", \".snowball-block-share .button\", function() {\n      var snowball = snowball || window.parent.snowball;\n      var button = jQuery(this);\n      var width = 500;\n      var height = 400;\n      var windowLeft = (screen.width/2) - (width/2);\n      var windowTop = (screen.height/2) - (height/2);\n      var opts = \"toolbar=0,status=0,width=\" + width + \",height=\" + height + \",top=\" + windowTop + \",left=\" + windowLeft;\n      var url;\n\n      if (button.hasClass(\"facebook\")) {\n        url = \"http://www.facebook.com/sharer.php?u=\" + encodeURIComponent(snowball.url);\n      } else if (button.hasClass(\"twitter\")) {\n        url = \"http://twitter.com/share?url=\" + encodeURIComponent(snowball.url) + \"&text=\" + encodeURIComponent(snowball.title);\n      } else if (button.hasClass(\"tumblr\")) {\n        url = \"https://www.tumblr.com/widgets/share/tool?posttype=link&canonicalUrl=\" + encodeURIComponent(snowball.url) + \"&title=\" + encodeURIComponent(snowball.title) + \"&content=\" + encodeURIComponent(snowball.excerpt);\n      } else {\n        url = \"https://plus.google.com/share?url=\" + encodeURIComponent(snowball.url);\n      }\n\n      window.open(url, \"share\", opts);\n    });\n\n  });\n})(jQuery);\n"],"sourceRoot":"/source/"}