{"version":3,"sources":["snowball-admin.js"],"names":["$","setHandlers","on","props","status","this","attr","logger","changesMade","debounce","snowball","title","val","each","trigger","css","parent","width","fixedsticky","type","data","addBlock","actions","push","action","tag","removeClass","addClass","show","hide","filter","dropdown","next","not","toggle","closest","form","mood","comment","find","fb","block","renderPreview","height","refreshEditors","confirmDelete","copyBlock","toggleClass","zoomPreview","index","editor","CodeMirror","refresh","prepend","append","length","initEditors","sortable","axis","cancel","change","containment","cursor","tolerance","click","e","keyCode","window","resize","populateSavedBlocks","b","savedblocks","toLowerCase","at","blockCode","blocks","name","names","text","end","key","hasOwnProperty","selector","input","value","is","prop","customCss","html","dataBlock","blockType","load","wpColorPicker","event","appendTo","insertAfter","eq","preview","contents","templates","fields","element","target","replace","regex","RegExp","author","blogname","blogurl","date","url","$html","blockScripts","detach","empty","previewScripts","callback","i","script","iframe","get","contentDocument","createElement","src","defaultScripts","onload","callback2","head","appendChild","innerHTML","body","style","cm","defaultCss","pluginsUrl","includesUrl","cssEditor","retrieveNonReadOnlyText","customStyle","data-type","scoped","defaultStylesheets","forEach","href","code","zoom","scale","-webkit-transform","transform","editors","elem","modeType","isReadOnly","fromTextArea","mode","htmlMode","readOnly","lineNumbers","lineWrapping","indentUnit","tabSize","theme","renderEditor","cssCode","split","nonReadOnlyCode","clone","remove","cursorPos","getCursor","scrollPos","getScrollInfo","top","startLine","line","ch","endLine","options","inclusiveLeft","setValue","markText","addLineClass","setCursor","scrollTo","readOnlyMark","getAllMarks","getValue","mark","lastReadOnlyLine","lines","fromLine","toLine","lastLine","getRange","parseBlock","htmlEditor","result","confirm","fn","delay","timer","context","args","arguments","clearTimeout","setTimeout","apply","article","Parse","initialize","Blocks","Object","extend","set","id","authorLogin","userLogin","save","Feedback","feedback","jQuery","document","ready","JSON","parse"],"mappings":"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","file":"snowball-admin.min.js","sourcesContent":["(function($) {\n  var changesMade = false;\n  var actions = [];\n\n  jQuery(document).ready(function() {\n    if ((snowball.savedblocks.length !== 0) && (snowball.savedblocks !== \"null\")) {\n      snowball.savedblocks = JSON.parse(snowball.savedblocks);\n      populateSavedBlocks();\n    } else {\n      snowball.savedblocks = [];\n    }\n\n    setHandlers();\n  });\n\n  function setHandlers() {\n    $(\"#publish, #save-post\").on(\"click\", function() {\n      var props = {};\n\n      if ($(this).attr(\"id\") == \"publish\") {\n        props.status = \"publish\";\n      } else {\n        props.status = \"draft\";\n      }\n\n      logger(props);\n\n      changesMade = false;\n    });\n\n    $(\"#title\").on(\"input\", debounce(function() {\n      snowball.title = $(this).val();\n      $(\".snowball-block\").each(function() {\n        $(this).trigger(\"render\");\n      });\n    }, 250));\n\n    $(\"#snowball-toolbar\")\n      .css(\"width\", $(\"#snowball-toolbar\").parent().width())\n      .fixedsticky();\n\n    $(\"#snowball-toolbar .block-button\").on(\"click\", function() {\n      var type = $(this).data(\"type\");\n      addBlock(type);\n      changesMade = true;\n\n      actions.push({\n        action: \"add\",\n        type: type\n      });\n    });\n\n    $(\"#snowball-toolbar .tag\").on(\"click\", function() {\n      var tag = $(this).attr(\"data-tag\");\n      $(\".tag.active\").removeClass(\"active\");\n      $(this).addClass(\"active\");\n\n      if (tag === \"all\") {\n        $(\"#snowball-toolbar .button\").show();\n      } else {\n        $(\"#snowball-toolbar .button\").hide().filter(\".\" + tag).show();\n      }\n    });\n\n    $(\"#snowball-toolbar .menu-toggle\").on(\"click\", function() {\n      var dropdown = $(this).next(\".menu-dropdown\");\n      $(\"#snowball-toolbar .menu-dropdown\").not(dropdown).hide();\n      dropdown.toggle();\n    });\n\n    $(\"#snowball-toolbar .menu .close\").on(\"click\", function() {\n      $(this).closest(\".menu-dropdown\").hide();\n    });\n\n    $(\"#snowball-toolbar .feedback .button\").on(\"click\", function() {\n      var form = $(this).closest(\".feedback\");\n      var mood = form.attr(\"data-mood\");\n      var comment = form.find(\"textarea\").val();\n\n      fb(mood, comment);\n\n      form.closest(\".menu-dropdown\").hide();\n      form.find(\"textarea\").val(\"\");\n    });\n\n    $(\"#snowball-settings .toggle\").on(\"click\", function() {\n      $(\"#snowball-settings ul\").toggle();\n    });\n\n    $(\"#snowball-main\")\n      .on(\"render\", \".snowball-block\", function() {\n        var block = $(this);\n        renderPreview(block);\n      })\n      .on(\"mousedown\", \".snowball-block\", function() {\n        $(\"#snowball-main\").height($(\"#snowball-main\").height());\n      })\n      .on(\"mouseup\", \".snowball-block\", function() {\n        $(\"#snowball-main\").height(\"auto\");\n      })\n      .on(\"input change paste\", \".snowball-tinker input, .snowball-tinker textarea, .snowball-tinker select\", debounce(function() {\n        var block = $(this).closest(\".snowball-block\");\n        block.trigger(\"render\");\n        refreshEditors(block);\n        changesMade = true;\n      }, 250))\n      .on(\"click\", \".snowball-delete\", function() {\n        var block = $(this).closest(\".snowball-block\");\n        var type = block.data(\"type\");\n\n        confirmDelete(block);\n      })\n      .on(\"click\", \".snowball-copy\", function() {\n        var block = $(this).closest(\".snowball-block\");\n        var type = block.data(\"type\");\n\n        copyBlock(block);\n\n        actions.push({\n          action: \"copy\",\n          type: type\n        });\n      })\n      .on(\"click\", \".snowball-zoom-toggle\", function() {\n        var block = $(this).closest(\".snowball-block\");\n        var type = block.data(\"type\");\n\n        block.find(\".snowball-code, .snowball-copy, .snowball-delete, .snowball-top, .snowball-bottom\").toggle();\n\n        block.toggleClass(\"modal\");\n        $(\"body\").toggleClass(\"modal\");\n        zoomPreview(block);\n\n        actions.push({\n          action: \"code\",\n          type: type\n        });\n\n        block.find(\".CodeMirror\").each(function(index, editor) {\n          editor.CodeMirror.refresh();\n        });\n      })\n      .on(\"click\", \".snowball-top\", function() {\n        var block = $(this).closest(\".snowball-block\");\n\n        if (block.index() > 0) {\n          block.parent().prepend(block);\n          changesMade = true;\n        }\n      })\n      .on(\"click\", \".snowball-bottom\", function() {\n        var block = $(this).closest(\".snowball-block\");\n\n        if (block.index() < ($(\".snowball-block\").length) - 1) {\n          block.parent().append(block);\n          changesMade = true;\n        }\n      })\n      .on(\"mouseover\", \".snowball-zoom-toggle\", function() {\n        var block = $(this).closest(\".snowball-block\");\n\n        if (block.find(\".snowball-code .CodeMirror\").length === 0) {\n          initEditors(block);\n        }\n      })\n      .on(\"change\", \".handsontable\", function() {\n        changesMade = true;\n      })\n      .sortable({\n        axis: \"y\",\n        cancel: \".snowball-block.modal, .snowball-title-button, button, textarea, input, select, .handsontable .wtHider, .CodeMirror, .toggle-buttons\",\n        change: function() {\n          changesMade = true;\n        },\n        containment: \"#snowball-main\",\n        cursor: \"move\",\n        tolerance: \"pointer\"\n      });\n\n    $(\"body\")\n      .on(\"click\", \"#modal-bg\", function() {\n        $(\".snowball-block.modal .snowball-zoom-toggle\").click();\n      })\n      .on(\"keydown\", function (e) {\n        if (e.keyCode === 27) { // ESC\n          $(\".snowball-block.modal .snowball-zoom-toggle\").click();\n        }\n      });\n\n    $(\"#adminmenuback\").on(\"mouseenter\", function() {\n      $(\"body\").addClass(\"show-menu\");\n    });\n\n    $(\"#adminmenuwrap\").on(\"mouseleave\", function() {\n      $(\"body\").removeClass(\"show-menu\");\n    });\n\n    $(\"#wpwrap\").on(\"click\", function() {\n      $(\"body\").removeClass(\"show-menu\");\n    });\n\n    $(window)\n      .resize(debounce(function() {\n        zoomPreview();\n      }, 250))\n      .resize(function() {\n        var fixedsticky = $(\".fixedsticky\");\n        fixedsticky.css(\"width\", fixedsticky.parent().width());\n      })\n      .on(\"beforeunload\", function(e) {\n        if (changesMade) {\n          return \"You may have unsaved changes.\";\n        }\n      });\n\n    $(\"#collapse-menu\").click(function() {\n      var fixedsticky = $(\".fixedsticky\");\n      fixedsticky.css(\"width\", fixedsticky.parent().width());\n      zoomPreview();\n    });\n  }\n\n  function populateSavedBlocks() {\n    for (var b in snowball.savedblocks) {\n      var block = snowball.savedblocks[b];\n      var type = block[\"blockType\"].toLowerCase();\n      // need to delete so snowball.addBlock works properly\n      delete block[\"blockType\"];\n      delete block[\"orderNumber\"];\n\n      addBlock(type, block);\n    }\n  }\n\n  function addBlock(type, data, at) {\n    var blockCode = snowball.blocks[type];\n    var name = snowball.names[type];\n    var block = $(\"<div class='snowball-block'>\" +\n                    \"<div class='snowball-gui'>\" +\n                      \"<div class='snowball-tinker'>\" +\n                        \"<div>\" +\n                          \"<div class='snowball-title'></div>\" +\n                          \"<div class='snowball-title-button-group'>\" +\n                            \"<div class='snowball-title-button snowball-copy' title='Copy block'><i class='fa fa-files-o'></i></div>\" +\n                            \"<div class='snowball-title-button snowball-delete' title='Delete block'>&times;</div>\" +\n                          \"</div>\" +\n                          \"<div class='snowball-title-button-group'>\" +\n                            \"<div class='snowball-title-button snowball-top' title='Move block to top'><i class='fa fa-angle-double-up'></i></div>\" +\n                            \"<div class='snowball-title-button snowball-bottom' title='Move block to bottom'><i class='fa fa-angle-double-down'></i></div>\" +\n                          \"</div>\" +\n                          \"<div class='snowball-title-button-group'>\" +\n                            \"<div class='snowball-title-button snowball-zoom-toggle' title='Edit code'><i class='fa fa-code'></i></div>\" +\n                          \"</div>\" +\n                        \"</div>\" +\n                      \"</div>\" +\n                      \"<iframe class='snowball-preview'></iframe>\" +\n                    \"</div>\" +\n                    \"<div class='snowball-code'>\" +\n                      \"<div class='snowball-html snowball-editor'>\" +\n                        \"<div class='snowball-code-title'>HTML</div>\" +\n                        \"<textarea class='snowball-editor-box' data-mode='xml'></textarea>\" +\n                      \"</div>\" +\n                      \"<div class='snowball-css snowball-editor'>\" +\n                        \"<div class='snowball-code-title'>CSS</div>\" +\n                        \"<textarea class='snowball-editor-box' data-mode='css'></textarea>\" +\n                      \"</div>\" +\n                    \"</div>\" +\n                  \"</div>\");\n\n    block\n      .addClass(\"snowball-block-\" + type)\n      .attr(\"data-type\", type)\n      .attr(\"data-name\", name)\n      .find(\".snowball-title\").text(name).end()\n      .find(\".snowball-tinker\").append(blockCode).end();\n\n    if (data) {\n      for (var key in data) {\n        if (data.hasOwnProperty(key)) {\n          var selector = \"[data-target='\" + key + \"']\";\n          var input = block.find(selector);\n          var value = data[key];\n          if (input) {\n            if (input.is(\":radio\")) {\n              input.filter(\"[value='\" +  value + \"']\").prop(\"checked\", true);\n            } else if (input.is(\":checkbox\")) {\n              input.prop(\"checked\", ((value == \"true\") || value === true));\n            } else {\n              input.val(value);\n            }\n          }\n        }\n\n        if (data.customCss) {\n          block.find(\"textarea[data-mode='css']\").html(data.customCss);\n        }\n      }\n\n\n    } else {\n      var dataBlock = {\n        blockType: type\n      };\n\n      snowball.savedblocks.push(dataBlock);\n    }\n\n    block\n      .find(\".snowball-preview\").load(function() {\n        renderPreview(block);\n      }).end()\n      .find(\".wp-color-picker\").wpColorPicker({\n        change: debounce(function (event) {\n          $(this)\n            .trigger(\"change\")\n            .attr(\"value\", $(this).val());\n        }, 250)\n      });\n\n    if (typeof at == \"undefined\") {\n      block.appendTo(\"#snowball-main\");\n    } else {\n      block.insertAfter($(\".snowball-block\").eq(at));\n    }\n    \n    zoomPreview(block);\n    block.trigger(\"open\");\n  }\n\n  function renderPreview(block) {\n    var type = block.data(\"type\");\n    var preview = block.find(\".snowball-preview\").contents();\n    var html = snowball.templates[type];\n    var selector = \"input[type='text'][data-target], input[type='email'][data-target], input[type='range'][data-target], input[type='hidden'][data-target], input[type='radio'][data-target]:checked, input[type='checkbox'][data-target]:checked, textarea[data-target], select[data-target]\";\n    var fields = block.find(selector);\n\n    fields.each(function(index, element) {\n      var target = $(this).data(\"target\");\n      var value = $(this).val();\n\n      if ((type === \"text\") && $(this).is(\"textarea\")) {\n        // For text blocks, replace \\n\\n with <p>\n        value = value.replace(/(.+?)\\n{2,}/g,'<p>$1</p>');\n      }\n      var regex = new RegExp(\"{{\" + target + \"}}\", \"g\");\n      html = html.replace(regex, value);\n    });\n\n    html = html.replace(/{{.+}}/g, \"\");\n\n    html = html.replace(/\\[author\\]/g, snowball.author)\n               .replace(/\\[blogname\\]/g, snowball.blogname)\n               .replace(/\\[blogurl\\]/g, snowball.blogurl)\n               .replace(/\\[date\\]/g, snowball.date)\n               .replace(/\\[url\\]/g, snowball.url);\n\n    if (snowball.title) {\n      html = html.replace(/\\[title\\]/g, snowball.title);\n    }\n\n    var $html = $(html);\n    var blockScripts = $html.find(\"script\").detach();\n\n    preview.find(\"body\").empty().append($html);\n    previewScripts(blockScripts, block);\n\n    if (block.width()) {\n      zoomPreview(block);\n    }\n\n    block.trigger(\"rendered\");\n  }\n\n  // create script elements from iframe document so js is executed in iframe's context\n  // append default scripts to head so they aren't repeated in article for each block\n  // append block scripts to body so they are included in article\n  // only block scripts with src are re-appended here\n  // block scripts with innerhtml must be evaled in snowball-preview.js\n\n  function previewScripts(blockScripts, block) {\n    var iframe = block.find(\".snowball-preview\");\n    var preview = iframe.contents();\n    var head = preview.find(\"head\");\n    var body = preview.find(\"body\");\n    var cm = block.find('.snowball-code .CodeMirror');\n    var defaultCss = \"\";\n\n    var pluginsUrl = snowball.pluginsUrl;\n    var includesUrl = snowball.includesUrl;\n\n    var style;\n\n    if (cm.length) {\n      var cssEditor = cm[1].CodeMirror;\n      style = retrieveNonReadOnlyText(cssEditor);\n    } else {\n      style = block.find(\"textarea[data-mode='css']\").html();\n    }\n\n    if (style) {\n      var customStyle = $(\"<style></style>\").attr({\"data-type\": \"custom\", \"scoped\": \"scoped\"});\n      customStyle.html(style);\n      body.find(\".snowball-block\").append(customStyle);\n    }\n\n    var defaultStylesheets = [\n                                pluginsUrl + \"/lib/d3-geomap/css/d3.geomap.css\",\n                                pluginsUrl + \"/lib/font-awesome/css/font-awesome.min.css\",\n                                pluginsUrl + \"/styles/min/snowball.min.css\",\n                                pluginsUrl + \"/styles/min/snowball-preview.min.css\"\n                              ];\n\n    var defaultScripts = [\n                            includesUrl + \"js/jquery/jquery.js\",\n                            \"https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js\",\n                            \"https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js\",\n                            pluginsUrl + \"/lib/d3-geomap/vendor/d3.geomap.dependencies.min.js\",\n                            pluginsUrl + \"/lib/d3-geomap/js/d3.geomap.min.js\",\n                            pluginsUrl + \"/scripts/min/snowball-preview.min.js\",\n                            pluginsUrl + \"/scripts/min/templates.min.js\"\n                          ];\n\n    defaultStylesheets.forEach(function(href) {\n      var code = \"<link rel='stylesheet' href='\" + href + \"'>\\n\";\n      defaultCss = defaultCss + code;\n    });\n\n    if(head.is(\":empty\")) {\n      head.html(\"<meta charset='utf-8'>\");\n      head.append(defaultCss);\n      callback(0);\n    } else {\n      callback2(0);\n    }\n\n    function callback(i) {\n      var script = iframe.get(0).contentDocument.createElement(\"script\");\n      script.src = defaultScripts[i];\n\n      if (i < defaultScripts.length - 1) {\n        script.onload = function() {\n          callback(i+1);\n        };\n      } else {\n        script.onload = function() {\n          callback2(0);\n        };\n      }\n\n      head[0].appendChild(script);\n    }\n\n    function callback2(i) {\n      if (i < blockScripts.length) {\n        var src = blockScripts.eq(i).attr(\"src\");\n        var script = iframe.get(0).contentDocument.createElement(\"script\");\n\n        if (src) {\n          script.src = src;\n          script.onload = function() {\n            callback2(i+1);\n          };\n        } else {\n          script.innerHTML = blockScripts.eq(i).html();\n        }\n\n        body.find(\".snowball-block\").get(0).appendChild(script);\n      }\n    }\n  }\n\n  function zoomPreview(block) {\n    var width;\n    var zoom;\n    var scale;\n\n    if (block) {\n      width = block.width() / 2;\n      zoom = (width < 800) ? width/800 : 1;\n      scale = \"scale(\" + zoom + \")\";\n\n      block.find(\".snowball-preview\").contents().find(\"html\").css({\"-webkit-transform\": scale, \"transform\": scale});\n    } else {\n      $(\".snowball-preview\").each(function() {\n        width = $(this).closest(\".snowball-block\").width() / 2;\n        zoom = (width < 800) ? width/800 : 1;\n        scale = \"scale(\" + zoom + \")\";\n\n        $(this).contents().find(\"html\").css({\"-webkit-transform\": scale, \"transform\": scale});\n      });\n    }\n  }\n\n  function initEditors(block) {\n    var preview = block.find(\".snowball-preview\").contents().find(\"body\");\n    var editors = block.find(\".snowball-editor-box\");\n\n    editors.each(function(index, elem) {\n      var modeType = $(elem).attr(\"data-mode\");\n      var isReadOnly = (modeType === \"xml\") ? true : false;\n\n      var editor = CodeMirror.fromTextArea(elem, {\n          mode: {name: modeType, htmlMode: true},\n          readOnly: isReadOnly,\n          lineNumbers: true,\n          lineWrapping: true,\n          indentUnit: 2,\n          tabSize: 2,\n          theme: \"monokai\"\n      });\n\n      renderEditor(preview, modeType, editor);\n\n      editor.on(\"change\", debounce(function() {\n        var block = $(elem).closest(\".snowball-block\");\n        renderPreview(block);\n        changesMade = true;\n      }, 250));\n\n    });\n  }\n\n  function renderEditor(preview, modeType, editor, cssCode) {\n    var code = \"\";\n    var length = 0;\n    if (modeType == \"css\") {\n      preview.find(\"style:not([data-type='custom'])\").each(function() {\n        code = code + $(this).html();\n      });\n      // code = preview.find(\"style:not([data-type='custom'])\").html();\n\n      if (code) {\n        code = code.replace(/^\\n+|\\n+$/g, '');\n        code = code + \"\\n\\n\";\n        length = code.split(/\\r\\n|\\r|\\n/).length - 1;\n      } else {\n        code = \"\";\n      }\n\n      if (cssCode) {\n        code = code + cssCode;\n      }\n\n      var nonReadOnlyCode = retrieveNonReadOnlyText(editor);\n      if (nonReadOnlyCode) {\n        code = code + nonReadOnlyCode;\n      }\n    } else if (modeType === \"xml\") {\n      var clone = preview.clone();\n      clone.find(\"style\").remove();\n      code = clone.html().replace(\"\\n\\n</section>\", \"\\n</section>\");\n      length = code.split(/\\r\\n|\\r|\\n/).length;\n    }\n\n    var cursorPos = editor.getCursor();\n    var scrollPos = editor.getScrollInfo().top;\n    var startLine = {line: 0, ch: 0};\n    var endLine = {line: length, ch: 0};\n    var options = {readOnly: true, inclusiveLeft: true};\n\n    editor.setValue(code);\n    editor.markText(startLine, endLine, options);\n\n    for (var i = 0; i < length; i++) {\n      editor.addLineClass(i, \"background\", \"readonly\");\n    }\n\n    editor.setCursor(cursorPos);\n    editor.scrollTo(null, scrollPos);\n  }\n\n  function retrieveNonReadOnlyText(editor) {\n    // there should only be one marked text object in editor.getAllMarks()\n    var readOnlyMark = editor.getAllMarks();\n    var code = editor.getValue();\n\n    if (readOnlyMark.length) {\n      var mark = readOnlyMark[0];\n      var lastReadOnlyLine = mark.lines.length;\n\n      if (lastReadOnlyLine < 2) {\n        code = editor.getValue();\n      } else {\n        var fromLine = {line:lastReadOnlyLine-1, ch:0};\n        var toLine = {line:editor.lastLine()+1, ch:0};\n        code = editor.getRange(fromLine, toLine);\n      }\n    }\n\n    return code;\n  }\n\n  function copyBlock(block) {\n    var type = block.data(\"type\");\n    var data = parseBlock(block);\n    var index = block.index();\n\n    if (data) {\n      addBlock(type, data, index);\n    }\n  }\n\n  function refreshEditors(block) {\n    var cm = block.find('.snowball-code .CodeMirror');\n\n    if (cm.length) {\n      var htmlEditor = cm[0].CodeMirror;\n      var cssEditor = cm[1].CodeMirror;\n      var preview = block.find(\".snowball-preview\").contents().find(\"body\");\n      renderEditor(preview, \"xml\", htmlEditor);\n      renderEditor(preview, \"css\", cssEditor);\n    }\n  }\n\n  function confirmDelete(block) {\n    var result = confirm(\"Are you sure you want to delete this block?\");\n    if (result) {\n      var type = block.data(\"type\");\n      \n      block\n        .trigger(\"close\")\n        .remove();\n\n      changesMade = true;\n\n      actions.push({\n        action: \"delete\",\n        type: type\n      });\n    }\n  }\n\n  function debounce(fn, delay) {\n    var timer = null;\n    return function () {\n      var context = this, args = arguments;\n      clearTimeout(timer);\n      timer = setTimeout(function () {\n        fn.apply(context, args);\n      }, delay);\n    };\n  }\n\n  function logger(props) {\n    var article = [];\n\n    $(\".snowball-block\").each(function() {\n      var type = $(this).data(\"type\");\n      article.push(type);\n    });\n\n    Parse.initialize(\"FwVMmzHookZZ5j9F9ILc2E5MT5ufabuV7hCXKSeu\",\"Q069j2TUEegDfQJXxxYp7OIZrgu7ySYcqmSU05pQ\");\n    var Blocks = Parse.Object.extend(\"Blocks\");\n    var blocks = new Blocks();\n    blocks.set('blogname', snowball.blogname);\n    blocks.set('blogurl', snowball.blogurl);\n    blocks.set('url', snowball.url);\n    blocks.set('postid', snowball.id);\n    blocks.set('status', props.status);\n    blocks.set('author', snowball.authorLogin);\n    blocks.set('user', snowball.userLogin);\n    blocks.set('article', article);\n    blocks.set('size', article.length);\n    blocks.set('actions', actions);\n    blocks.save();\n\n    actions = [];\n  }\n\n  function fb(mood, comment) {\n    Parse.initialize(\"FwVMmzHookZZ5j9F9ILc2E5MT5ufabuV7hCXKSeu\",\"Q069j2TUEegDfQJXxxYp7OIZrgu7ySYcqmSU05pQ\");\n    var Feedback = Parse.Object.extend(\"Feedback\");\n    var feedback = new Feedback();\n    feedback.set('blogname', snowball.blogname);\n    feedback.set('blogurl', snowball.blogurl);\n    feedback.set('url', snowball.url);\n    feedback.set('postid', snowball.id);\n    feedback.set('author', snowball.author);\n    feedback.set('mood', mood);\n    feedback.set('comment', comment);\n    feedback.save();\n  }\n\n})(jQuery);\n"],"sourceRoot":"/source/"}