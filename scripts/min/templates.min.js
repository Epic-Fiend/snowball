function drawMap(t){var a=a||window.parent.snowball,n=a.pluginsUrl+"/lib/d3-geomap",e=t.find(".json-usa").val(),o=t.find(".map").get(0),r=parseInt(t.find("input.quantize").val()),l=t.find("input.color").val(),s=colorbrewer[l][r],i=t.find(".map-type").val(),c=n+"/topojson/countries/USA.json",d=d3.geo.albersUsa,p=800;if("world"===i&&(e=t.find(".json-world").val(),c=n+"/topojson/world/countries.json",d=d3.geo.equirectangular,p=100),e){t.find(".map").empty();var u=d3.geomap.choropleth().geofile(c).projection(d).column("Value").unitId("fips").scale(p).translate([400,200]).colors(s).legend(!0);d3.select(o).datum(JSON.parse(e)).call(u.draw,u).selectAll("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 500 400")}}function drawScatterplot(t){var a=t.find(".json").val();if(a){var n=t.find(".chart").get(0),e=t.find(".size").val(),o=JSON.parse(a),r=[],l=[],s=[];o.forEach(function(t){r.push([t.X,t.Y]),l.push(t.X),s.push(t.Y)});var i={top:40,right:40,bottom:60,left:60},c=800-i.left-i.right,d=400-i.top-i.bottom,p=d3.scale.linear().domain([0,d3.max(l)]).range([0,c]),u=d3.scale.linear().domain([0,d3.max(s)]).range([d,0]),m=d3.select(n).append("svg:svg").attr("width",c+i.right+i.left).attr("height",d+i.top+i.bottom).attr("class","chart"),f=m.append("g").attr("transform","translate("+i.left+","+i.top+")").attr("width",c).attr("height",d).attr("class","main"),h=d3.svg.axis().scale(p).orient("bottom");f.append("g").attr("transform","translate(0,"+d+")").attr("class","main axis date").call(h);var w=d3.svg.axis().scale(u).orient("left");f.append("g").attr("transform","translate(0,0)").attr("class","main axis date").call(w);var g=f.append("svg:g");g.selectAll("scatter-dots").data(s).enter().append("svg:circle").attr("cy",function(t){return u(t)}).attr("cx",function(t,a){return p(l[a])}).attr("r",e)}}!function(t){t(document).ready(function(){var a=t(".snowball-block-choropleth");a.each(function(){drawMap(t(this))})})}(jQuery),function(t){t(document).ready(function(){t("body").on("click",".snowball-block-contact .submit",function(){var a=t(this).closest("form"),n=a.find("[name='to']").val(),e=a.find("[name='subject']").val(),o=a.find("[name='confirmation']").val(),r="",l=a.find("input, textarea").not("[type='hidden']");l.each(function(){var a=t(this).val();r=t(this).attr("name")?r+"\n\n"+t(this).attr("name")+": "+a:r+"\n\n"+a});var s={action:"mail_before_submit",to:n,subject:e,message:r};window.parent&&(snowball=window.parent.snowball),jQuery.post(snowball.adminUrl+"admin-ajax.php",s,function(t){a.text(o)})})})}(jQuery),function(t){t(document).ready(function(){var a=t(".snowball-block-scatterplot");a.each(function(){drawScatterplot(t(this))})})}(jQuery),function(t){t(document).ready(function(){t("body").on("click",".snowball-block-share .button",function(){var t,a=a||window.parent.snowball,n=jQuery(this),e=500,o=400,r=screen.width/2-e/2,l=screen.height/2-o/2,s="toolbar=0,status=0,width="+e+",height="+o+",top="+l+",left="+r;t=n.hasClass("facebook")?"http://www.facebook.com/sharer.php?u="+encodeURIComponent(a.url):n.hasClass("twitter")?"http://twitter.com/share?url="+encodeURIComponent(a.url)+"&text="+encodeURIComponent(a.title):n.hasClass("tumblr")?"https://www.tumblr.com/widgets/share/tool?posttype=link&canonicalUrl="+encodeURIComponent(a.url)+"&title="+encodeURIComponent(a.title)+"&content="+encodeURIComponent(a.excerpt):"https://plus.google.com/share?url="+encodeURIComponent(a.url),window.open(t,"share",s)})})}(jQuery);
//# sourceMappingURL=templates.min.js.map